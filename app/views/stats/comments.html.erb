<% content_for :title, 'Stats- comments' %>

<h1>Stats for Comments</h1>

<div class="stats">
  <div>
    <%= @total_comments %> comments received from <%= @total_commenters %> commenters
  </div>

  <span class="inline">
    <table>
      <thead>
      <tr>
        <th colspan="3">Comments by Status</th>
      </tr>
      <tr>
        <th>Comment Status Type</th>
        <th># of Comments</th>
        <th>%</th>
      </tr>
      </thead>

      <tbody>
        <tr>
          <td>No comment status assigned</td>
          <td><%= @comments_with_no_status_type %></td>
          <td ><%= format_percent(@comments_with_no_status_type,@total_comments) %></td>
        </tr>
      <% @comments_by_status_type.each do |row| %>
        <tr>
          <td><%= link_to row.status_text, comments_path({comment_status_type_id: row.id}) %></td>
          <td class="<%= css_order_in_list('status',row.order_in_list)%>"><%= link_to row.num_comments, comments_path({comment_status_type_id: row.id}) %></td>
          <td class="<%= css_order_in_list('status',row.order_in_list)%>"><%= format_percent(row.num_comments,@total_comments) %></td>
        </tr>
      <% end %>
        <tr>
          <td><%= link_to "Total", comments_path %></td>
          <td><%= link_to @total_comments, comments_path %></td>
          <td>100%</td>
        </tr>
      </tbody>
    </table>
  </span>

  <span class="inline">
    <table>
      <thead>
        <tr>
          <th colspan="3">Comments by whether Categories have been assigned</th>
        </tr>
        <tr>
          <th></th>
          <th># of Comments</th>
          <th>%</th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td><%= "One or more categories have been assigned" %></td>
          <td><%= @comments_with_categories %></td>
          <td><%= format_percent(@comments_with_categories,@total_comments) %></td>
        </tr>
        <tr>
          <td><%= "No categories have been assigned" %></td>
          <td><%= @comments_without_categories %></td>
          <td><%= format_percent(@comments_without_categories,@total_comments) %></td>
        </tr>
        <tr>
          <td><%= link_to "Total", comments_path %></td>
          <td><%= link_to @total_comments, comments_path %></td>
          <td>100%</td>
        </tr>
      </tbody>
    </table>
  </span>

  <span class="inline">
    <table>
      <thead>
        <tr>
          <th colspan="3">Comments by Source</th>
        </tr>
        <tr>
          <th>Comment Source</th>
          <th># of Comments</th>
          <th>%</th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td><%= "Imported from DAS website" %></td>
          <td><%= @comments_imported_from_DAS %></td>
          <td><%= format_percent(@comments_imported_from_DAS,@total_comments) %></td>
        </tr>
        <tr>
          <td><%= link_to "Manually entered", comments_path({manually_entered: true}) %></td>
          <td><%= link_to @comments_manually_entered, comments_path({manually_entered: true}) %></td>
          <td><%= format_percent(@comments_manually_entered,@total_comments) %></td>
        </tr>
        <tr>
          <td><%= link_to "Total", comments_path %></td>
          <td><%= link_to @total_comments, comments_path %></td>
          <td>100%</td>
        </tr>
      </tbody>
    </table>
  </span>
</div>